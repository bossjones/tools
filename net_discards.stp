# show function which generates kfree_skb at interfae with ifindex
# @ton31337

probe begin
{
        ansi_clear_screen();
        printf("Date\t\t\t\tSymbol name\n");
}

probe kernel.trace("kfree_skb")
{
        try {
                ifindex = $skb->dev->ifindex;
                if(ifindex == strtol(@1, 10)) {
                        printf("%s\t%s\n", ctime(gettimeofday_s()), symdata($location));
                }
        } catch {}
}
